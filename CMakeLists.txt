INCLUDE (CheckIncludeFiles)
INCLUDE (CheckSymbolExists)
INCLUDE (FindPerl)
INCLUDE (UsePkgConfig)

SET (CMAKE_C_FLAGS "-std=gnu99 -Werror -Wall -Winline -I/usr/include/slang-2")

PROJECT (spoon C)

ADD_EXECUTABLE (spoon 
	signal.c 
	keyboard.c
	screen.c 
	term.c 
	protocol.c 
	main.c
	buffer.c)


EXEC_PROGRAM(${PERL_EXECUTABLE}
	ARGS ${CMAKE_CURRENT_SOURCE_DIR}/findlua.pl
	OUTPUT_VARIABLE LUA)

MESSAGE(STATUS "Found lua: ${LUA}")


# As far as I know, the *_INCDIR and *_LIBDIR variables are useless.
PKGCONFIG (glib-2.0 GLIB_INCDIR GLIB_LIBDIR GLIB_LDFLAGS GLIB_CFLAGS)
PKGCONFIG (gnet-2.0 GNET_INCDIR GNET_LIBDIR GNET_LDFLAGS GNET_CFLAGS)
PKGCONFIG (${LUA}   LUA_INCDIR LUA_LIBDIR LUA_LDFLAGS LUA_CFLAGS)



ADD_DEFINITIONS(${GLIB_CFLAGS})
ADD_DEFINITIONS(${GNET_CFLAGS})
ADD_DEFINITIONS(${LUA_CFLAGS})

SET_TARGET_PROPERTIES(spoon PROPERTIES LINK_FLAGS 
	"${GLIB_LDFLAGS} ${GNET_LDFLAGS} ${LUA_LDFLAGS}")


#SET(CMAKE_REQUIRED_FLAGS "${CMAKE_C_FLAGS}")

#CHECK_SYMBOL_EXISTS(
