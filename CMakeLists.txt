PROJECT (MOONSHINE C)

CMAKE_MINIMUM_REQUIRED(VERSION 2.4.6)

SET(SRC "${MOONSHINE_SOURCE_DIR}")
SET(BIN "${MOONSHINE_BINARY_DIR}") 
SET(CMAKE_ALLOW_LOOSE_LOOP_CONSTRUCTS 1)
SET(CMAKE_MODULE_PATH "${SRC}/cmake")

FIND_PACKAGE(GLIB REQUIRED)
FIND_PACKAGE(GTHREAD REQUIRED)
FIND_PACKAGE(SLANG REQUIRED)
FIND_PACKAGE(LUA REQUIRED)

INCLUDE_DIRECTORIES(BEFORE
	${SLANG_INCLUDE_DIR}
	${LUA_INCLUDE_DIR}
	${GLIB_INCLUDE_DIRS}
	${GTHREAD_INCLUDE_DIRS} 
	${SRC})

ADD_DEFINITIONS("-std=gnu99 -Wall -Winline")
ADD_DEFINITIONS("${GLIB_DEFINITIONS} ${GTHREAD_DEFINITIONS}")

SET(VER "p2+")
SET(MOONSHINE_VERSION ${VER})
SET(MOONSHINE_RUNTIME "${CMAKE_INSTALL_PREFIX}/share/moonshine/${VER}")
SET(MOONSHINE_MODULES "${CMAKE_INSTALL_PREFIX}/lib/moonshine/${VER}")

INCLUDE_DIRECTORIES(${MOONSHINE_BINARY_DIR})

CONFIGURE_FILE(config.h.in
	${MOONSHINE_BINARY_DIR}/moonshine/config.h
	@ONLY IMMEDIATE)

ADD_SUBDIRECTORY(core)
ADD_SUBDIRECTORY(modules ${PROJECT_BINARY_DIR}/modules/moonshine)
#ADD_SUBDIRECTORY(runtime/moonshine)
